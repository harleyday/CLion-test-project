<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Harley Day" />
  <meta name="dcterms.date" content="2018-04-06" />
  <title>AD double switch model MATLAB code</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">AD double switch model MATLAB code</h1>
<p class="author">Harley Day</p>
<p class="date">04/06/2018</p>
</header>
<nav id="TOC">
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#making-a-model-in-matlab">Making a model in MATLAB</a></li>
<li><a href="#simulation">Simulation</a><ul>
<li><a href="#syntax">Syntax</a><ul>
<li><a href="#name-value-pair-arguments">Name-value pair arguments</a></li>
<li><a href="#output-options">Output options</a></li>
<li><a href="#note"><em>NOTE</em></a></li>
</ul></li>
<li><a href="#examples">Examples</a></li>
</ul></li>
<li><a href="#reproduction-of-figures-from-elisas-paper-dominguezhuttinger">Reproduction of figures from Elisaâ€™s paper <span class="citation" data-cites="dominguezHuttinger">[1]</span></a></li>
<li><a href="#figure-2a-reproduction">Figure 2<strong>A</strong> reproduction</a></li>
<li><a href="#atopic-dermatitis-gata3-switch-model-adgswitchmodel-equations">Atopic dermatitis GATA3 switch model (<code>ADGSwitchModel</code>) equations</a><ul>
<li><a href="#steady-states">Steady states</a></li>
</ul></li>
<li><a href="#atopic-dermatitis-t-helper-2-cell-model-adth2model-equations">Atopic dermatitis T-helper 2 cell model (<code>ADTh2Model</code>) equations</a></li>
<li><a href="#atopic-dermatitis-t-helper-2-memory-cell-model-adth2memorymodel-equations">Atopic dermatitis T-helper 2 memory cell model (<code>ADTh2MemoryModel</code>) equations</a></li>
<li><a href="#atopic-dermatitis-t-helper-2-quorum-signalling-model-adth2quorummodel-equations">Atopic dermatitis T-helper 2 quorum signalling model (<code>ADTh2QuorumModel</code>) equations</a><ul>
<li><a href="#steady-states-1">Steady States</a><ul>
<li><a href="#healthy-steady-state">Healthy steady state</a></li>
</ul></li>
</ul></li>
<li><a href="#bibliography">Bibliography</a></li>
</ul>
</nav>
<p><a href="https://bg-pc208z1.bg.ic.ac.uk:8446/viewType.html?buildTypeId=ADModels_TestPackage"><img src="https://bg-pc208z1.bg.ic.ac.uk:8446/app/rest/builds/buildType:(id:ADModels_TestPackage)/statusIcon.svg" alt="Build status" /></a></p>
<h1 id="installation">Installation</h1>
<p>Download and install the ADModels MATLAB toolbox from <a href="https://github.com/harleyday/ADModels/releases/latest">here</a>. Download the <code>ADModels.mltbx</code> file to your working directory, double-click on this file from within MATLAB, and it will be installed. After this, the model classes may be loaded into your namespace using the <code>import</code> command. For example, <code>import ADModels.ADGSwitchModel</code>. This allows you to use this model class in your code from this point onwards.</p>
<p>Alternatively, you can use the <code>downloadGitHubRelease</code> function from <a href="https://github.com/harleyday/MATLAB-GitHub-release-download">here</a>, and download from the MATLAB command prompt</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb1-1" data-line-number="1">downloadGitHubRelease ( <span class="st">&#39;harleyday/ADModels&#39;</span>, <span class="st">&#39;latest&#39;</span>,...</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">                        <span class="st">&#39;token&#39;</span>, <span class="st">&#39;&lt;your-30-character-personal-access-token&gt;&#39;</span>,...</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">                        <span class="st">&#39;install&#39;</span>, true,...</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                        <span class="st">&#39;overwrite&#39;</span>, true );</a></code></pre></div>
<h1 id="making-a-model-in-matlab">Making a model in MATLAB</h1>
<p>We use MATLAB classes to make model simulation and analysis simpler to think about at the command line.</p>
<p>All function, parameters, and state variables are stored within an object, which is an instance of the <code>ADGSwitchModel</code> class. This class can be instantiated as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb2-1" data-line-number="1">model = ADGSwitchModel()</a></code></pre></div>
<p>If you do not place a semicolon after the initialisation statement, the model will display pertinent information to the console:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb3-1" data-line-number="1">model =</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">AD double switch model.</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">Parameters</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">________________________________________</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">parameters =</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">    P_env    gamma_B    kappa_P    alpha_I    delta_P    kappa_B    gamma_R    delta_B    gamma_G    kappa_D    delta_D</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    ____    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">     <span class="fl">95</span>        <span class="fl">1</span>         <span class="fl">0.6</span>       <span class="fl">0.25</span>         <span class="fl">1</span>         <span class="fl">0.5</span>        <span class="fl">10</span>         <span class="fl">0.1</span>         <span class="fl">1</span>          <span class="fl">4</span>         <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">switchValues =</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">           R_switch    G_switch</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">           ________    ________</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">    off      <span class="fl">26.6</span>          <span class="fl">0</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18">    on         <span class="fl">40</span>         <span class="fl">85</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">RFunction =</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">    R_off    R_on</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">    _____    ____</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"></a>
<a class="sourceLine" id="cb3-24" data-line-number="24">      <span class="fl">0</span>      <span class="fl">16.7</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"></a>
<a class="sourceLine" id="cb3-26" data-line-number="26">KFunction =</a>
<a class="sourceLine" id="cb3-27" data-line-number="27">    K_off    m_on    beta</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">    _____    ____    ____</a>
<a class="sourceLine" id="cb3-29" data-line-number="29"></a>
<a class="sourceLine" id="cb3-30" data-line-number="30">      <span class="fl">0</span>      <span class="fl">0.45</span>    <span class="fl">6.71</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"></a>
<a class="sourceLine" id="cb3-32" data-line-number="32">GFunction =</a>
<a class="sourceLine" id="cb3-33" data-line-number="33">    G_off    G_on</a>
<a class="sourceLine" id="cb3-34" data-line-number="34">    _____    ____</a>
<a class="sourceLine" id="cb3-35" data-line-number="35"></a>
<a class="sourceLine" id="cb3-36" data-line-number="36">      <span class="fl">0</span>       <span class="fl">1</span></a></code></pre></div>
<p>Parameters can be set at construction time:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb4-1" data-line-number="1">modelParamTable = table ( <span class="fl">95</span>, <span class="fl">1</span>, <span class="fl">0.6</span>, <span class="fl">0.25</span>, <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">10</span>, <span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">0.5</span>,...</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">                                    <span class="st">&#39;VariableNames&#39;</span>, {<span class="st">&#39;P_env&#39;</span>,<span class="st">&#39;gamma_B&#39;</span>,<span class="st">&#39;kappa_P&#39;</span>,<span class="st">&#39;alpha_I&#39;</span>,<span class="st">&#39;delta_P&#39;</span>,<span class="st">&#39;kappa_B&#39;</span>,<span class="st">&#39;gamma_R&#39;</span>,<span class="st">&#39;delta_B&#39;</span>,<span class="st">&#39;gamma_G&#39;</span>,<span class="st">&#39;kappa_D&#39;</span>,<span class="st">&#39;delta_D&#39;</span>} );</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">switchValuesTable = table ( [ <span class="fl">26.6</span>; <span class="fl">40</span> ], [ <span class="fl">0</span>; <span class="fl">85</span> ], ...</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                                    <span class="st">&#39;VariableNames&#39;</span>, {<span class="st">&#39;R_switch&#39;</span>, <span class="st">&#39;G_switch&#39;</span>}, ...</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                                    <span class="st">&#39;RowNames&#39;</span>, {<span class="st">&#39;off&#39;</span>, <span class="st">&#39;on&#39;</span>} );</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">model = ADGSwitchModel ( <span class="st">&#39;parameters&#39;</span>, modelParamTable,...</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">                                  <span class="st">&#39;switchValues&#39;</span>, switchValuesTable );</a></code></pre></div>
<p>â€¦or after constructionâ€¦</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb5-1" data-line-number="1">model.RFunction = table ( <span class="fl">0</span>, <span class="fl">16.7</span>, <span class="st">&#39;VariableNames&#39;</span>, {<span class="st">&#39;R_off&#39;</span>, <span class="st">&#39;R_on&#39;</span>} );</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">model.parameters = modelParamTable;</a></code></pre></div>
<p>You can adjust specific parameters by chaining the adress together with dot notation as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb6-1" data-line-number="1">model.parameters.kappa_P = <span class="fl">0.9</span></a></code></pre></div>
<p>this will change the value of <code>kappa_P</code> only, leaving all other parameters unchanged.</p>
<hr />
<h1 id="simulation">Simulation</h1>
<p>The model can be simulated by calling the <code>simulate</code> method.</p>
<h2 id="syntax">Syntax</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb7-1" data-line-number="1">[t, y] = model.simulate ( times ) <span class="co">% providing just the times of interest makes the simulation start at steady states</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">[t, y] = model.simulate ( times, y0 ) <span class="co">% providing the optional initial condition parameter</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">[t, y] = model.simulate ( times, y0, <span class="st">&#39;parameters&#39;</span>, parameters, <span class="st">&#39;states&#39;</span>, states, <span class="st">&#39;switchValues&#39;</span>, switchValues ) <span class="co">% a number of name-value pairs are also available</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">[t, y, tSw, ySw] = model.simulate ( times, y0, <span class="st">&#39;parameters&#39;</span>, parameters, <span class="st">&#39;states&#39;</span>, states, <span class="st">&#39;switchValues&#39;</span>, switchValues ) <span class="co">% optional output arguments return switch information</span></a></code></pre></div>
<h3 id="name-value-pair-arguments">Name-value pair arguments</h3>
<ul>
<li><code>'parameters'</code>: a table of parameter values with variable names <code>{'P_env','gamma_B','kappa_P','alpha_I','delta_P','kappa_B','gamma_R','delta_B','gamma_G','kappa_D','delta_D'}</code>.</li>
<li><code>'states'</code>: a character, cell array or vector specifying the state variables you wish to simulate. For example: <code>B</code>, <code>{'P', 'B'}</code> or <code>[1, 2]</code>. States are returned in the same order as the vector or cell array as columns of the <code>y</code> output.</li>
<li><code>'switchValues'</code>: a table specifying the switch value thresholds which must have variable names <code>{'R_switch', 'G_switch'}</code>, and row names <code>{'off', 'on'}</code>.</li>
</ul>
<h3 id="output-options">Output options</h3>
<ul>
<li><code>tSw</code> and <code>ySw</code>: the two optional output arguments return the states of the switches <code>ySw</code> at times <code>tSw</code>. The <code>tSw</code> output is required since switching times <code>tSw</code> may be different from the desired sample points of the simulation. For example, we may wish to evaluate the solution at <code>times = [1,2,5,10]</code>, but the switches may change at <code>tSw = [0.8, 0.95, 2]</code>.</li>
</ul>
<h3 id="note"><em>NOTE</em></h3>
<p>The <code>simulate</code> method automatically checks the initial conditions to check for violation of the switch assumptions. If conflicting parameters exist, the user is prompted in the command window to resolve the issues.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb8-1" data-line-number="1">import ADModels.ADGSwitchModel;</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">model = ADGSwitchModel;</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">times = [<span class="fl">0</span>,<span class="fl">10</span>];</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">[t, y, tSw, ySw] = model.simulate ( times, <span class="st">&#39;switchStates&#39;</span>, [true, false] );</a></code></pre></div>
<p>The command window asks pertinent questions:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb9-1" data-line-number="1">R_switch switch is on but P is below Pminus. Turn R_switch switch off?</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">[YES] [no] [cancel] [continue]:</a></code></pre></div>
<h2 id="examples">Examples</h2>
<p>We can check that the steady states are valid by running a simulation from steady state (fig. <a href="#fig:SteadyStateSimulation">1</a> A). The optional extra output arguments can be used to obtain the switching information(fig. <a href="#fig:SteadyStateSimulation">1</a> B).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb10-1" data-line-number="1">model = ADGSwitchModel;</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">times = [ <span class="fl">0</span>, <span class="fl">10</span> ];</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">[ t, y, tSw, ySw ] = model.simulate ( times );</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">plot ( t, y ); <span class="co">% subplot A below</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">stairs ( tSw, ySw ); <span class="co">% subplot B below</span></a></code></pre></div>
<figure>
<img src="img/SteadyStateSimulation.png" alt="fig. 1: Steady state simulation - A; plot of P, B and D and B; plot of switch states over time" id="fig:SteadyStateSimulation" /><figcaption><span>fig. 1:</span> Steady state simulation - <strong>A</strong>; plot of P, B and D and <strong>B</strong>; plot of switch states over time</figcaption>
</figure>
<p>You can also use name-value pairs for various useful options as in the constructor function. For example, we can select only the <code>P</code> and <code>B</code> states to be returned.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb11-1" data-line-number="1">model = ADGSwitchModel()</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">times = [<span class="fl">1</span>,<span class="fl">10</span>];</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">y0 = model.steadyStates;</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">[t, y] = model.simulate ( times, y0, <span class="st">&#39;selection&#39;</span>, {<span class="st">&#39;P&#39;</span>, <span class="st">&#39;B&#39;</span>} );</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">plot(t, y);</a></code></pre></div>
<hr />
<h1 id="reproduction-of-figures-from-elisas-paper-dominguezhuttinger">Reproduction of figures from Elisaâ€™s paper <span class="citation" data-cites="dominguezHuttinger">[1]</span></h1>
<p>I am able to reproduce the figures 2b from <span class="citation" data-cites="dominguezHuttinger">[1]</span> using the following scripts.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb12-1" data-line-number="1">import ADModels.ADGSwitchModel;</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">modelRecovery = ADGSwitchModel;</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">y0 = modelRecovery.steadyStates;</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">y0.P = <span class="fl">40.1</span>;</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">modelRecovery.parameters.kappa_P = <span class="fl">0.6</span>;</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">modelRecovery.parameters.alpha_I = <span class="fl">0.25</span>;</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">initialSwitchStates = table ( true, false, <span class="st">&#39;VariableNames&#39;</span>, {<span class="st">&#39;R_switch&#39;</span>, <span class="st">&#39;G_switch&#39;</span>} );</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">[t, y, tSw, ySw] = modelRecovery.simulate ( linspace ( <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">1000</span> ), y0, <span class="st">&#39;switchStates&#39;</span>, initialSwitchStates, <span class="st">&#39;selection&#39;</span>, <span class="st">&#39;B&#39;</span> );</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">fig1 = figure ( <span class="fl">1</span> );</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">fig1.PaperUnits = <span class="st">&#39;centimeters&#39;</span>;</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">fig1.PaperPosition = [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">15</span> <span class="fl">8</span>];</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">ax1 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>);</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">plot( ax1, t, y, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> );</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">ylim ( ax1, [<span class="fl">0</span>, <span class="fl">1</span>] );</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">xlabel ( ax1, {<span class="st">&#39;time (days)&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">ylabel ( ax1, {<span class="st">&#39;barrier integrity&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">ax1.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">legend ( ax1, {<span class="st">&#39;$B$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb12-20" data-line-number="20">ax2 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>);</a>
<a class="sourceLine" id="cb12-21" data-line-number="21">stairs ( ax2, tSw, ySw, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> )</a>
<a class="sourceLine" id="cb12-22" data-line-number="22">xlabel ( ax2, {<span class="st">&#39;time (days)&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb12-23" data-line-number="23">ylabel ( ax2, {<span class="st">&#39;switch state&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">yticks ( ax2, [<span class="fl">0</span>, <span class="fl">1</span>] );</a>
<a class="sourceLine" id="cb12-25" data-line-number="25">yticklabels ( ax2, {<span class="st">&#39;off&#39;</span>, <span class="st">&#39;on&#39;</span>} );</a>
<a class="sourceLine" id="cb12-26" data-line-number="26">ax2.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb12-27" data-line-number="27">legend ( ax2, {<span class="st">&#39;$R_{switch}$&#39;</span>, <span class="st">&#39;$G_{switch}$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a></code></pre></div>
<figure>
<img src="img/Recovery.png" alt="fig. 2: Recovery simulation" id="fig:Recovery" /><figcaption><span>fig. 2:</span> Recovery simulation</figcaption>
</figure>
<hr />
<div class="sourceCode" id="cb13"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb13-1" data-line-number="1">import ADModels.ADGSwitchModel;</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">modelBistable = ADGSwitchModel;</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">y0 = modelBistable.steadyStates;</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">y0.P = <span class="fl">40.1</span>;</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">modelBistable.parameters.kappa_P = <span class="fl">0.6</span>;</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">modelBistable.parameters.alpha_I = <span class="fl">0.0325</span>;</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">[t, y, tSw, ySw] = modelBistable.simulate ( linspace ( <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1000</span> ), y0, <span class="st">&#39;switchStates&#39;</span>, [true, false], <span class="st">&#39;selection&#39;</span>, <span class="st">&#39;B&#39;</span> );</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">y0.P = <span class="fl">55</span>;</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">[tLow, yLow, tSwLow, ySwLow] = modelBistable.simulate ( linspace ( <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1000</span> ), y0, <span class="st">&#39;switchStates&#39;</span>, [true, false], <span class="st">&#39;selection&#39;</span>, <span class="st">&#39;B&#39;</span> );</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">fig2 = figure ( <span class="fl">2</span> );</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">fig2.PaperUnits = <span class="st">&#39;centimeters&#39;</span>;</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">fig2.PaperPosition = [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">15</span> <span class="fl">8</span>];</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">ax1 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>);</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">p1 = plot( ax1, t, y, tLow, yLow, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> );</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">p1(<span class="fl">1</span>).Color = <span class="st">&#39;b&#39;</span>;</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">p1(<span class="fl">2</span>).Color = <span class="st">&#39;b&#39;</span>;</a>
<a class="sourceLine" id="cb13-18" data-line-number="18">xlabel ( ax1, <span class="st">&#39;time (days)&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb13-19" data-line-number="19">ylabel ( ax1, <span class="st">&#39;barrier integrity&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb13-20" data-line-number="20">ax1.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb13-21" data-line-number="21">legend ( ax1,  {<span class="st">&#39;$B$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb13-22" data-line-number="22">ax2 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>);</a>
<a class="sourceLine" id="cb13-23" data-line-number="23">hold on;</a>
<a class="sourceLine" id="cb13-24" data-line-number="24">p2 = stairs ( ax2, tSw, ySw, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> );</a>
<a class="sourceLine" id="cb13-25" data-line-number="25">p2(<span class="fl">1</span>).Color = <span class="st">&#39;b&#39;</span>;</a>
<a class="sourceLine" id="cb13-26" data-line-number="26">p2(<span class="fl">2</span>).Color = <span class="st">&#39;r&#39;</span>;</a>
<a class="sourceLine" id="cb13-27" data-line-number="27">p3 = stairs ( ax2, tSwLow, ySwLow, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> );</a>
<a class="sourceLine" id="cb13-28" data-line-number="28">p3(<span class="fl">1</span>).Color = <span class="st">&#39;b&#39;</span>;</a>
<a class="sourceLine" id="cb13-29" data-line-number="29">p3(<span class="fl">2</span>).Color = <span class="st">&#39;r&#39;</span>;</a>
<a class="sourceLine" id="cb13-30" data-line-number="30">xlabel ( ax2, <span class="st">&#39;time (days)&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb13-31" data-line-number="31">ylabel ( ax2, <span class="st">&#39;switch state&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb13-32" data-line-number="32">yticks ( ax2, [<span class="fl">0</span>, <span class="fl">1</span>] );</a>
<a class="sourceLine" id="cb13-33" data-line-number="33">yticklabels ( ax2, {<span class="st">&#39;off&#39;</span>, <span class="st">&#39;on&#39;</span>} );</a>
<a class="sourceLine" id="cb13-34" data-line-number="34">ax2.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb13-35" data-line-number="35">legend ( ax2, {<span class="st">&#39;$R_{switch}$&#39;</span>, <span class="st">&#39;$G_{switch}$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a></code></pre></div>
<figure>
<img src="img/Bistable.png" alt="fig. 3: Bistability simulation" id="fig:Bistable" /><figcaption><span>fig. 3:</span> Bistability simulation</figcaption>
</figure>
<hr />
<div class="sourceCode" id="cb14"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb14-1" data-line-number="1">import ADModels.ADGSwitchModel</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">modelOscillation = ADGSwitchModel;</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">y0 = modelOscillation.steadyStates;</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">y0.P = <span class="fl">40.1</span>;</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">modelOscillation.parameters.kappa_P = <span class="fl">0.9</span>;</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">modelOscillation.parameters.alpha_I = <span class="fl">0.25</span>;</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8">[t, y, tSw, ySw] = modelOscillation.simulate ( linspace ( <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1000</span> ), y0, <span class="st">&#39;switchStates&#39;</span>, [true, false], <span class="st">&#39;selection&#39;</span>, <span class="st">&#39;B&#39;</span> );</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">fig3 = figure ( <span class="fl">3</span> );</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">fig3.PaperUnits = <span class="st">&#39;centimeters&#39;</span>;</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">fig3.PaperPosition = [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">15</span> <span class="fl">8</span>];</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">ax1 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>);</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">plot( ax1, t, y, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> );</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">ylim ( ax1, [<span class="fl">0</span>, <span class="fl">1</span>] );</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">xlabel ( ax1, <span class="st">&#39;time (days)&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">legend ( ax1, {<span class="st">&#39;$B$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">ylabel ( ax1, <span class="st">&#39;barrier integrity&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">ax1.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb14-19" data-line-number="19">ax2 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>);</a>
<a class="sourceLine" id="cb14-20" data-line-number="20">stairs ( ax2, tSw, ySw, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> )</a>
<a class="sourceLine" id="cb14-21" data-line-number="21">xlabel ( ax2, <span class="st">&#39;time (days)&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb14-22" data-line-number="22">ylabel ( ax2, <span class="st">&#39;switch state&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">yticks ( ax2, [<span class="fl">0</span>, <span class="fl">1</span>] );</a>
<a class="sourceLine" id="cb14-24" data-line-number="24">yticklabels ( ax2, {<span class="st">&#39;off&#39;</span>, <span class="st">&#39;on&#39;</span>} );</a>
<a class="sourceLine" id="cb14-25" data-line-number="25">ax2.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb14-26" data-line-number="26">legend ( ax2, {<span class="st">&#39;$R_{switch}$&#39;</span>, <span class="st">&#39;$G_{switch}$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a></code></pre></div>
<figure>
<img src="img/Oscillation.png" alt="fig. 4: Oscillation simulation" id="fig:Oscillation" /><figcaption><span>fig. 4:</span> Oscillation simulation</figcaption>
</figure>
<hr />
<div class="sourceCode" id="cb15"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb15-1" data-line-number="1">import ADModels.ADGSwitchModel</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">modelChronicDamage = ADGSwitchModel;</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">y0 = modelChronicDamage.steadyStates;</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">y0.P = <span class="fl">40.1</span>;</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">modelChronicDamage.parameters.kappa_P = <span class="fl">0.9</span>;</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">modelChronicDamage.parameters.alpha_I = <span class="fl">0.0325</span>;</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">[t, y, tSw, ySw] = modelChronicDamage.simulate ( linspace ( <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1000</span> ), y0, <span class="st">&#39;switchStates&#39;</span>, [true, false], <span class="st">&#39;selection&#39;</span>, <span class="st">&#39;B&#39;</span> );</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">fig4 = figure ( <span class="fl">4</span> );</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">fig4.PaperUnits = <span class="st">&#39;centimeters&#39;</span>;</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">fig4.PaperPosition = [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">15</span> <span class="fl">8</span>];</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">ax1 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>);</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">plot( ax1, t, y, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> );</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">xlabel ( ax1, <span class="st">&#39;time (days)&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb15-15" data-line-number="15">ylabel ( ax1, <span class="st">&#39;barrier integrity&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">ax1.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb15-17" data-line-number="17">legend ( ax1,  {<span class="st">&#39;$B$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">ax2 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>);</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">stairs ( ax2, tSw, ySw, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> )</a>
<a class="sourceLine" id="cb15-20" data-line-number="20">xlabel ( ax2, <span class="st">&#39;time (days)&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb15-21" data-line-number="21">ylabel ( ax2, <span class="st">&#39;switch state&#39;</span>, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">yticks ( ax2, [<span class="fl">0</span>, <span class="fl">1</span>] );</a>
<a class="sourceLine" id="cb15-23" data-line-number="23">yticklabels ( ax2, {<span class="st">&#39;off&#39;</span>, <span class="st">&#39;on&#39;</span>} );</a>
<a class="sourceLine" id="cb15-24" data-line-number="24">ax2.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb15-25" data-line-number="25">legend ( ax2, {<span class="st">&#39;$R_{switch}$&#39;</span>, <span class="st">&#39;$G_{switch}$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a></code></pre></div>
<figure>
<img src="img/ChronicDamage.png" alt="fig. 5: Chronic damage simulation" id="fig:ChronicDamage" /><figcaption><span>fig. 5:</span> Chronic damage simulation</figcaption>
</figure>
<hr />
<h1 id="figure-2a-reproduction">Figure 2<strong>A</strong> reproduction</h1>
<p>The bifurcation analysis fig. <a href="#fig:BifurcationAnalysis">6</a> can be reproduced by running the MATLAB script <a href="fig2A.m"><code>fig2A.m</code></a>.</p>
<figure>
<img src="img/fig2A.png" alt="fig. 6: Bifurcation diagram" id="fig:BifurcationAnalysis" /><figcaption><span>fig. 6:</span> Bifurcation diagram</figcaption>
</figure>
<hr />
<p>Here is the original figure 2 (fig. <a href="#fig:fig2_original">7</a>) from <span class="citation" data-cites="dominguezHuttinger">[1]</span> (see figure B - Recovery plot for barrier integrity for comparison).</p>
<figure>
<img src="img/fig2_original.jpg" alt="fig. 7: Original figure 2 from [1]" id="fig:fig2_original" /><figcaption><span>fig. 7:</span> Original figure 2 from <span class="citation" data-cites="dominguezHuttinger">[1]</span></figcaption>
</figure>
<hr />
<h1 id="atopic-dermatitis-gata3-switch-model-adgswitchmodel-equations">Atopic dermatitis GATA3 switch model (<code>ADGSwitchModel</code>) equations</h1>
<p><span class="math display">\[
\begin{aligned}
\frac{dP(t)}{dt} &amp;=&amp; P_{env}\frac{\kappa_P}{1+\gamma_BB(t)} - \alpha_IR(t)P(t) - \delta_PP(t)\\
\frac{dB(t)}{dt} &amp;=&amp; \kappa_B \frac{1}{1+\gamma_RR(t)}\frac{1}{1+\gamma_GG(t)}(1-B(t)) - \delta_BK(t)B(t)\\
\frac{dD(t)}{dt} &amp;=&amp; \kappa_D R(t) - \delta_D D(t)
\end{aligned}
\]</span></p>
<p><span class="math display">\[
(R(t), K(t)) = \left\{
  \begin{aligned}
      (R_{off}, K_{off})&amp;, &amp;\text{if } P(t) &lt; P^- \text{ or } \{P^-\leq P(t) \leq P^+ \text{ and } R(t^-)=R_{off}\}\\
      (R_{on}, K_{on}=m_{on}P(t)-\beta)&amp;, &amp;\text{if } P(t) &gt; P^+ \text{ or } \{P^-\leq P(t) \leq P^+ \text{ and } R(t^-)=R_{on}\}
  \end{aligned}
\right.
\]</span></p>
<p><span class="math display">\[
G(t) = \left\{
  \begin{aligned}
      G_{off}&amp;, &amp;\text{if } D(t) &lt; P^+ \text{ and } P(t^-) = G_{off}\\
      G_{off}&amp;, &amp;\text{if } D(t) \geq P^+ \text{ and } P(t^-) = G_{on}
  \end{aligned}
\right.
\]</span></p>
<hr />
<h2 id="steady-states">Steady states</h2>
<blockquote>
<p>Things get a little more complex here. Please read this only if you need to understand source code for steady states or want a headache.</p>
</blockquote>
<p>The AD double switch model is a hybrid dynamical system, and so it has different steady states depending on the state of the switches.</p>
<p>When the <span class="math inline">\(R\)</span> switch is off, the steady states are as follows: <span class="math display">\[
\begin{aligned}
P^* &amp;=&amp; \frac{P_{env}\kappa_P}{(1+\gamma_BB^*)(\delta_P+\alpha_IR_{off})}\\
B^* &amp;=&amp; \frac{(1+\gamma_RR_{off})(1+\gamma_GG)}{(1+\gamma_RR_{off})(1+\gamma_GG)+\kappa_B\delta_BK_{off}}\\
D^* &amp;=&amp; \frac{\kappa_DR_{off}}{\delta_D}
\end{aligned}
\]</span></p>
<p>When the R switch is on, the system changes to incorporate an additional steady state (which may or may not exist depending on parameter values) <span class="math display">\[
\begin{aligned}
D^* = \frac{\kappa_DR_{on}}{\delta_D}
\end{aligned}
\]</span> Lumped parameters: <span class="math display">\[
\begin{aligned}
A &amp;=&amp; (1+\gamma_RR_{on})(1+\gamma_GG)\\
Q &amp;=&amp; \frac{P_{env}\kappa_P}{\delta_P + \alpha_IR_{on}}
\end{aligned}
\]</span> Quadratic coefficients: <span class="math display">\[
\begin{aligned}
a &amp;=&amp;  \kappa_B\gamma_B\\
b &amp;=&amp;  \kappa_B + \delta_B A m_{on} Q - \gamma_B\kappa_B - \beta\delta_B A\\
c &amp;=&amp; -\kappa_B
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
B^* &amp;=&amp; \frac{-b + \sqrt{b^2-4ac}}{2a}\\
P^* &amp;=&amp; \frac{Q}{1+\gamma_BB^*}
\end{aligned}
\]</span></p>
<p>These analytical results are hardcoded into the <code>steadyStates</code> propertyâ€™s get method. The steadyStates property is implemented as a <a href="https://uk.mathworks.com/help/matlab/matlab_oop/access-methods-for-dependent-properties.html">MATLAB dependent property</a>.</p>
<p>The steady states can be calculated once the model object is given all of the relevant parameters (it has the parameters from <span class="citation" data-cites="dominguezHuttinger">[1]</span> by default).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb16-1" data-line-number="1">steadyStates = model.steadyStates</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb17-1" data-line-number="1">steadyStates =</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">  <span class="fl">1</span>Ã—<span class="fl">3</span> table</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">     P      B    D</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">    ____    _    _</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">    <span class="fl">28.5</span>    <span class="fl">1</span>    <span class="fl">0</span></a></code></pre></div>
<p>The value of the steady states is recalculated every time the property value is retrieved from the object. This means that the steady state value will automatically change in response to parameter changes:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb18-1" data-line-number="1">steadyStates = model.steadyStates <span class="co">% return the steady states</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">model.parameters.kappa_P = <span class="fl">0.9</span>; <span class="co">% changing a parameter</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3">steadyStates = model.steadyStates <span class="co">% the steady states will be different now</span></a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb19-1" data-line-number="1">steadyStates =</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  <span class="fl">1</span>Ã—<span class="fl">3</span> table</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">     P      B    D</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">    ____    _    _</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"></a>
<a class="sourceLine" id="cb19-8" data-line-number="8">    <span class="fl">28.5</span>    <span class="fl">1</span>    <span class="fl">0</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"></a>
<a class="sourceLine" id="cb19-11" data-line-number="11">steadyStates =</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">  <span class="fl">1</span>Ã—<span class="fl">3</span> table</a>
<a class="sourceLine" id="cb19-14" data-line-number="14"></a>
<a class="sourceLine" id="cb19-15" data-line-number="15">      P      B    D</a>
<a class="sourceLine" id="cb19-16" data-line-number="16">    _____    _    _</a>
<a class="sourceLine" id="cb19-17" data-line-number="17"></a>
<a class="sourceLine" id="cb19-18" data-line-number="18">    <span class="fl">42.75</span>    <span class="fl">1</span>    <span class="fl">0</span></a></code></pre></div>
<h1 id="atopic-dermatitis-t-helper-2-cell-model-adth2model-equations">Atopic dermatitis T-helper 2 cell model (<code>ADTh2Model</code>) equations</h1>
<p><span class="math display">\[
\begin{aligned}
\frac{dP(t)}{dt} &amp;=&amp; P_{env}\frac{\kappa_P}{1+\gamma_BB(t)} - \frac{\alpha_IR(t)P(t)}{1+\gamma_{PL}L} - \delta_PP(t)\\
\frac{dB(t)}{dt} &amp;=&amp; \kappa_B \frac{1}{1+\gamma_RR(t)}\frac{1}{1+\gamma_{BL}L(t)}(1-B(t)) - \delta_BK(t)B(t)\\
\frac{dT_2(t)}{dt} &amp;=&amp; \kappa_2 R(t) - \delta_2 T_2(t)\\
\frac{dL(t)}{dt} &amp;=&amp; \kappa_LT_2(t) - \delta_LL(t)\\
\frac{T_1(t)}{dt} &amp;=&amp; \kappa_1R(t)L(t) - \delta_1T_1(t)
\end{aligned}
\]</span></p>
<p><span class="math display">\[
(R(t), K(t)) = \left\{
  \begin{aligned}
      (R_{off}, K_{off})&amp;, &amp;\text{if } P(t) &lt; P^- \text{ or } \{P^-\leq P(t) \leq P^+ \text{ and } R(t^-)=R_{off}\}\\
      (R_{on}, K_{on}=m_{on}P(t)-\beta)&amp;, &amp;\text{if } P(t) &gt; P^+ \text{ or } \{P^-\leq P(t) \leq P^+ \text{ and } R(t^-)=R_{on}\}
  \end{aligned}
\right.
\]</span></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">State variable</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Concentration of pathogen</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(B\)</span></td>
<td style="text-align: left;">Barrier integrity</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_1\)</span></td>
<td style="text-align: left;">Concentration of Th1 cells</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(L\)</span></td>
<td style="text-align: left;">IL-4 concentration</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_2\)</span></td>
<td style="text-align: left;">Concentration of Th2 cells</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(R\)</span></td>
<td style="text-align: left;">Toll-like receptor activation</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(K\)</span></td>
<td style="text-align: left;">Concentration of kallikreins</td>
</tr>
</tbody>
</table>
<h1 id="atopic-dermatitis-t-helper-2-memory-cell-model-adth2memorymodel-equations">Atopic dermatitis T-helper 2 memory cell model (<code>ADTh2MemoryModel</code>) equations</h1>
<p><span class="math display">\[
\begin{aligned}
\frac{dP(t)}{dt} &amp;=&amp; P_{env}\frac{\kappa_P}{1+\gamma_BB(t)} - \frac{\alpha_IR(t)P(t)}{1+\gamma_{PT}T_e} - \delta_PP(t)\\
\frac{dB(t)}{dt} &amp;=&amp; \kappa_B \frac{1}{1+\gamma_RR(t)}\frac{1}{1+\gamma_{BT}T_e(t)}(1-B(t)) - \delta_BK(t)B(t)\\
\frac{dT_e(t)}{dt} &amp;=&amp; \kappa_e R(t) + \alpha_eP(t)[TCR](t)T_m(t)- \delta_e T_e(t)\\
\frac{T_m(t)}{dt} &amp;=&amp; \kappa_mR(t) - \delta_mT_m(t)
\end{aligned}
\]</span></p>
<p><span class="math display">\[
(R(t), K(t)) = \left\{
  \begin{aligned}
      (R_{off}, K_{off})&amp;, &amp;\text{if } P(t) &lt; P^- \text{ or } \{P^-\leq P(t) \leq P^+ \text{ and } R(t^-)=R_{off}\}\\
      (R_{on}, K_{on}=m_{on}P(t)-\beta)&amp;, &amp;\text{if } P(t) &gt; P^+ \text{ or } \{P^-\leq P(t) \leq P^+ \text{ and } R(t^-)=R_{on}\}
  \end{aligned}
\right.
\]</span></p>
<p>We are considering a T-cell receptor (TCR) switch function as follows:</p>
<p><span class="math display">\[
TCR(t) = \left\{
  \begin{aligned}
      TCR_{off}&amp;, &amp;\text{if } P(t) &lt; P_{TCR}\\
      TCR_{on} &amp;, &amp;\text{if } P(t) \geq P_{TCR}
  \end{aligned}
\right.
\]</span></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">State variable</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Concentration of pathogen</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(B\)</span></td>
<td style="text-align: left;">Barrier integrity</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_e\)</span></td>
<td style="text-align: left;">Concentration of Th2 effector cells</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_m\)</span></td>
<td style="text-align: left;">Concentration of Th2 memory cells</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R\)</span></td>
<td style="text-align: left;">Toll-like receptor activation</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(K\)</span></td>
<td style="text-align: left;">Concentration of kallikreins</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(TCR\)</span></td>
<td style="text-align: left;">T-cell receptor activation</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 78%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Meaning</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P_{env}\)</span></td>
<td style="text-align: left;">Environmental stress load</td>
<td style="text-align: left;">95</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\gamma_B\)</span></td>
<td style="text-align: left;">Barrier-mediated inhibition of pathogen infiltration</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\kappa_P\)</span></td>
<td style="text-align: left;">Normal skin permeability</td>
<td style="text-align: left;">0.6</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\alpha_I\)</span></td>
<td style="text-align: left;">Rate of pathogen eradication by innate immune responses</td>
<td style="text-align: left;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\gamma_{PT}\)</span></td>
<td style="text-align: left;">Rate of inhibition of innate immune responses due to Th2 effector-derived IL-4</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\delta_P\)</span></td>
<td style="text-align: left;">Basal pathogen death rate</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\kappa_B\)</span></td>
<td style="text-align: left;">Barrier recovery rate</td>
<td style="text-align: left;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\gamma_R\)</span></td>
<td style="text-align: left;">Innate immunity-mediated inhibition of barrier Reproduction</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\gamma_{BT}\)</span></td>
<td style="text-align: left;">Rate of inhibition of barrier formation due to Th2 effector-derived IL-4</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\delta_B\)</span></td>
<td style="text-align: left;">Rate of kallikrein-dependent barrier degradation</td>
<td style="text-align: left;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\kappa_e\)</span></td>
<td style="text-align: left;">Th2 effector cell activation rate by innate immune responses</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\alpha_e\)</span></td>
<td style="text-align: left;">Rate of Th2 effector activation from memory cells by superantigens</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta_e\)</span></td>
<td style="text-align: left;">Rate of Th2 effector cell death</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\kappa_m\)</span></td>
<td style="text-align: left;">Th2 memory cell production rate by innate immune responses</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta_m\)</span></td>
<td style="text-align: left;">Rate of degradation of memory cells</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P^-\)</span></td>
<td style="text-align: left;">Receptor inactivation thresholds</td>
<td style="text-align: left;">26.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P^+\)</span></td>
<td style="text-align: left;">Receptor activation threshold</td>
<td style="text-align: left;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(R_{off}\)</span></td>
<td style="text-align: left;">Receptor off level</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R_{on}\)</span></td>
<td style="text-align: left;">Receptor on level</td>
<td style="text-align: left;">16.7</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(K_{off}\)</span></td>
<td style="text-align: left;">Kallikrein off level</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(m_{on}\)</span></td>
<td style="text-align: left;">Slope of the linear relation between <span class="math inline">\(P(t)\)</span> and <span class="math inline">\(K_{on}\)</span></td>
<td style="text-align: left;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\beta\)</span></td>
<td style="text-align: left;">Y-intercept of the linear relation between <span class="math inline">\(P(t)\)</span> and <span class="math inline">\(K_{on}\)</span></td>
<td style="text-align: left;">6.71</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P_{TCR}\)</span></td>
<td style="text-align: left;">TCR activation/inactivation threshold</td>
<td style="text-align: left;">26.6</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(TCR_{off}\)</span></td>
<td style="text-align: left;">T cell receptor off level</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(TCR_{on}\)</span></td>
<td style="text-align: left;">T cell receptor on level</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
<p>Example simulation with this new model.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode matlab"><code class="sourceCode matlab"><a class="sourceLine" id="cb20-1" data-line-number="1">import ADModels.ADGSwitchModel;</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">import ADModels.ADTh2MemoryModel;</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"></a>
<a class="sourceLine" id="cb20-4" data-line-number="4">modelGSwitch = ADGSwitchModel;</a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">% y0 = modelGSwitch.steadyStates;</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">% y0 = removevars(y0, &#39;D&#39;);</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">% y0.Te = 0;</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">% y0.Tm = 0;</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9">y0 = table ( <span class="fl">10</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="st">&#39;VariableNames&#39;</span>, {<span class="st">&#39;P&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;Te&#39;</span>,<span class="st">&#39;Tm&#39;</span>});</a>
<a class="sourceLine" id="cb20-10" data-line-number="10"></a>
<a class="sourceLine" id="cb20-11" data-line-number="11">modelRecovery = ADTh2MemoryModel;</a>
<a class="sourceLine" id="cb20-12" data-line-number="12">initialSwitchStates = table ( false, false, <span class="st">&#39;VariableNames&#39;</span>, {<span class="st">&#39;R_switch&#39;</span>, <span class="st">&#39;TCR_switch&#39;</span>} );</a>
<a class="sourceLine" id="cb20-13" data-line-number="13">[t, y, tSw, ySw] = modelRecovery.simulate ( linspace ( <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">1000</span> ), y0, <span class="st">&#39;switchStates&#39;</span>, initialSwitchStates, <span class="st">&#39;selection&#39;</span>, {<span class="st">&#39;P&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;Te&#39;</span>,<span class="st">&#39;Tm&#39;</span>} );</a>
<a class="sourceLine" id="cb20-14" data-line-number="14">fig1 = figure ( <span class="fl">1</span> );</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">fig1.PaperUnits = <span class="st">&#39;centimeters&#39;</span>;</a>
<a class="sourceLine" id="cb20-16" data-line-number="16">fig1.PaperPosition = [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">15</span> <span class="fl">8</span>];</a>
<a class="sourceLine" id="cb20-17" data-line-number="17">ax1 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>);</a>
<a class="sourceLine" id="cb20-18" data-line-number="18">plot( ax1, t, y, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> );</a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">% ylim ( ax1, [0, 1] );</span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20">xlabel ( ax1, {<span class="st">&#39;time (days)&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb20-21" data-line-number="21">ylabel ( ax1, {<span class="st">&#39;barrier integrity&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb20-22" data-line-number="22">ax1.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb20-23" data-line-number="23">legend ( ax1, {<span class="st">&#39;P&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;Te&#39;</span>,<span class="st">&#39;Tm&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb20-24" data-line-number="24">ax2 = subplot(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>);</a>
<a class="sourceLine" id="cb20-25" data-line-number="25">stairs ( ax2, tSw, ySw, <span class="st">&#39;LineWidth&#39;</span>, <span class="fl">2</span> )</a>
<a class="sourceLine" id="cb20-26" data-line-number="26">xlabel ( ax2, {<span class="st">&#39;time (days)&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb20-27" data-line-number="27">ylabel ( ax2, {<span class="st">&#39;switch state&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a>
<a class="sourceLine" id="cb20-28" data-line-number="28">yticks ( ax2, [<span class="fl">0</span>, <span class="fl">1</span>] );</a>
<a class="sourceLine" id="cb20-29" data-line-number="29">yticklabels ( ax2, {<span class="st">&#39;off&#39;</span>, <span class="st">&#39;on&#39;</span>} );</a>
<a class="sourceLine" id="cb20-30" data-line-number="30">ax2.TickLabelInterpreter = <span class="st">&#39;latex&#39;</span>;</a>
<a class="sourceLine" id="cb20-31" data-line-number="31">legend ( ax2, {<span class="st">&#39;$R_{switch}$&#39;</span>, <span class="st">&#39;$TCR_{switch}$&#39;</span>}, <span class="st">&#39;Interpreter&#39;</span>, <span class="st">&#39;latex&#39;</span> );</a></code></pre></div>
<h1 id="atopic-dermatitis-t-helper-2-quorum-signalling-model-adth2quorummodel-equations">Atopic dermatitis T-helper 2 quorum signalling model (<code>ADTh2QuorumModel</code>) equations</h1>
<p><span class="math display">\[
\begin{aligned}
\frac{dN_1(t)}{dt} &amp;=&amp; r_1N_1\frac{K_1 - N_1 - \alpha_{12}N_2 - \frac{\alpha_IRN_1}{1+\gamma_{PT}T_e}}{K_1}\\
\frac{dN_2(t)}{dt} &amp;=&amp; r_2N_2\frac{K_2 - N_2 - \alpha_{21}N_1 - \frac{\alpha_IRN_2}{1+\gamma_{PT}T_e}}{K_2}\\
\frac{dP(t)}{dt} &amp;=&amp; H(N_2)\frac{\kappa_P}{1+\gamma_BB(t)} - \delta_PP(t)\\
\frac{dB(t)}{dt} &amp;=&amp; \kappa_B \frac{1}{1+\gamma_RR(t)}\frac{1}{1+\gamma_{BT}T_e(t)}(1-B(t)) - \delta_BK(t)B(t)\\
\frac{dT_e(t)}{dt} &amp;=&amp; \kappa_e R(t) + \alpha_eP(t)T_m(t)- \delta_e T_e(t)\\
\frac{T_m(t)}{dt} &amp;=&amp; \kappa_mR(t) - \delta_mT_m(t)
\end{aligned}
\]</span></p>
<p>Where the commensal species require less resource than their pathogenis counterpart. <span class="math display">\[\alpha_{21}&gt;\alpha_{12}\]</span> Since these competing species compete for the same resource (space and nutrient on the skin), we can also assume <span class="math display">\[\alpha_{21} = \frac{1}{\alpha_{12}}\]</span></p>
<p><span class="math display">\[
(R(t), K(t)) = \left\{
  \begin{aligned}
      (R_{off}, K_{off})&amp;, &amp;\text{if } P(t) &lt; P^- \text{ or } \{P^-\leq P(t) \leq P^+ \text{ and } R(t^-)=R_{off}\}\\
      (R_{on}, K_{on}=m_{on}P(t)-\beta)&amp;, &amp;\text{if } P(t) &gt; P^+ \text{ or } \{P^-\leq P(t) \leq P^+ \text{ and } R(t^-)=R_{on}\}
  \end{aligned}
\right.
\]</span></p>
<p>We consider quorum sensing leading to production of virulence factors as follows:</p>
<p><span class="math display">\[
H(N_2) = \left\{
  \begin{aligned}
      0  &amp;, &amp;\text{if } N_2 &lt; N_Q\\
      N2 &amp;, &amp;\text{if } N_2 \geq N_Q
  \end{aligned}
\right.
\]</span></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">State variable</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Concentration of antigens</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(B\)</span></td>
<td style="text-align: left;">Barrier integrity</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_e\)</span></td>
<td style="text-align: left;">Concentration of Th2 effector cells</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_m\)</span></td>
<td style="text-align: left;">Concentration of Th2 memory cells</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R\)</span></td>
<td style="text-align: left;">Toll-like receptor activation</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(K\)</span></td>
<td style="text-align: left;">Concentration of kallikreins</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(N_1\)</span></td>
<td style="text-align: left;">Concentration of commensal species</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(N_2\)</span></td>
<td style="text-align: left;">Concentration of pathogenic species</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r_1\)</span></td>
<td style="text-align: left;">Rate of growth of commensal species <span class="math inline">\(N_1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(K_1\)</span></td>
<td style="text-align: left;">Carrying capacity for species <span class="math inline">\(N_1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r_2\)</span></td>
<td style="text-align: left;">Rate of growth of pathogenic species <span class="math inline">\(N_2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(K_2\)</span></td>
<td style="text-align: left;">Carrying capacity for species <span class="math inline">\(N_2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\gamma_B\)</span></td>
<td style="text-align: left;">Barrier-mediated inhibition of pathogen infiltration</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\kappa_P\)</span></td>
<td style="text-align: left;">Normal skin permeability</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\alpha_I\)</span></td>
<td style="text-align: left;">Rate of pathogen eradication by innate immune responses</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\gamma_{PT}\)</span></td>
<td style="text-align: left;">Rate of inhibition of innate immune responses due to Th2 effector-derived IL-4</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta_P\)</span></td>
<td style="text-align: left;">Basal pathogen death rate</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\kappa_B\)</span></td>
<td style="text-align: left;">Barrier recovery rate</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\gamma_R\)</span></td>
<td style="text-align: left;">Innate immunity-mediated inhibition of barrier Reproduction</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\gamma_BT\)</span></td>
<td style="text-align: left;">Rate of inhibition of barrier formation due to Th2 effector-derived IL-4</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta_B\)</span></td>
<td style="text-align: left;">Rate of kallikrein-dependent barrier degradation</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\kappa_e\)</span></td>
<td style="text-align: left;">Th2 effector cell activation rate by innate immune responses</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\alpha_E\)</span></td>
<td style="text-align: left;">Rate of Th2 effector activation from memory cells by superantigens</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\delta_e\)</span></td>
<td style="text-align: left;">Rate of Th2 effector cell death</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\kappa_m\)</span></td>
<td style="text-align: left;">Th2 memory cell production rate by innate immune responses</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\delta_m\)</span></td>
<td style="text-align: left;">Rate of degradation of memory cells</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R_{off}\)</span></td>
<td style="text-align: left;">Receptor off level</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(R_{on}\)</span></td>
<td style="text-align: left;">Receptor on level</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(K_{off}\)</span></td>
<td style="text-align: left;">Kallikrein off level</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(m_{on}\)</span></td>
<td style="text-align: left;">Slope of the linear relation between <span class="math inline">\(P(t)\)</span> and <span class="math inline">\(K_{on}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\beta\)</span></td>
<td style="text-align: left;">Y-intercept of the linear relation between <span class="math inline">\(P(t)\)</span> and <span class="math inline">\(K_{on}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(N_Q\)</span></td>
<td style="text-align: left;">Quorum-sensing activation/inactivation threshold</td>
</tr>
</tbody>
</table>
<h2 id="steady-states-1">Steady States</h2>
<h3 id="healthy-steady-state">Healthy steady state</h3>
<p>This steady state corresponds to the situation for a healthy, AD-free individual. The innate immune receptors are off, as is the quorum-sensing switch since the concentration of N_2 and pathogen is very low.</p>
<p>Let us first assume that the innate immune receptors are not activated. This allows us to deduce that the adaptive immune response is not active.</p>
<p><span class="math display">\[\Rightarrow T_e=0\]</span> <span class="math display">\[\Rightarrow T_m=0\]</span></p>
<p>Since the innate immune receptors are not activated, the kallikrein switch is also off, and so:</p>
<p><span class="math display">\[\frac{dB}{dt} = \kappa_B\frac{1}{(1+\gamma_RR)(1+\gamma_{BT}T_e)}(1-B)\]</span> <span class="math display">\[\Rightarrow B=1\]</span></p>
<p>We are now left with the assumption that the quorum-sensing switch is off.</p>
<p><span class="math display">\[\Rightarrow P=0 \iff N_2&lt;N_Q\]</span></p>
<p>If we define these inequality relationship between <span class="math inline">\(\alpha_{12}\)</span> and <span class="math inline">\(\alpha_{21}\)</span>: <span class="math display">\[\alpha_{21}&gt;\alpha_{12}\]</span> and <span class="math display">\[K_1=K_2\]</span> Then it follows that if</p>
<p><span class="math display">\[\frac{K_1}{\alpha_{12}}&gt;K_2\]</span> and <span class="math display">\[\frac{K_2}{\alpha_{21}}&lt;K_1\]</span> Then species <span class="math inline">\(N_1\)</span> becomes dominant, and species <span class="math inline">\(N_2\)</span> (the pathogenic species) dies out.</p>
<p><span class="math display">\[\Rightarrow N_1=K_1\]</span> <span class="math display">\[\Rightarrow N_2=0\]</span></p>
<p>This corresponds to a healthy steady state, with a non-pathogenic microbiome.</p>
<h1 id="bibliography" class="unnumbered">Bibliography</h1>
<div id="refs" class="references">
<div id="ref-dominguezHuttinger">
<p>[1] E. DomÃ­nguez-HÃ¼ttinger <em>et al.</em>, â€œMathematical modeling of atopic dermatitis reveals â€˜double-switchâ€™ mechanisms underlying 4 common disease phenotypes,â€ <em>Journal of Allergy and Clinical Immunology</em>, vol. 139, no. 6, pp. 1861â€“1872.e7, Jun. 2017.</p>
</div>
</div>
</body>
</html>
